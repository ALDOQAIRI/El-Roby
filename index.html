<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø§Ù„Ø±ÙˆØ¨ÙŠ | Ù„Ù„Ù…ØµÙ†Ø¹Ø§Øª ÙˆØ§Ù„Ù„Ø­ÙˆÙ…</title>

    <meta name="google-site-verification" content="M4AVPnmakVfGb3OU5CIqN--Dqi4C-6KYQn-MhFM0ymU" />
    <meta name="description" content="Ù…Ù†ÙŠÙˆ Ø§Ù„Ø±ÙˆØ¨ÙŠ Ù„Ù„Ø­ÙˆÙ… ÙˆØ§Ù„Ù…ØµÙ†Ø¹Ø§Øª. Ø®Ø¯Ù…Ø© ØªÙˆØµÙŠÙ„ Ù„Ù„Ù…Ù†Ø§Ø²Ù„.">

    <link rel="icon" href="https://pps.whatsapp.net/v/t61.24694-24/491837277_975255798065507_888456427333343564_n.jpg?ccb=11-4&oh=01_Q5Aa3AGbSm6G-sE8jIgjSx6QlkI7NJYu9I2N-wkffkMFp-7qRA&oe=69317C7B&_nc_sid=5e03e0&_nc_cat=108" type="image/png">
    
    <!-- Ø®Ø· Cairo Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Firebase & Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

    <style>
         :root {
            --primary: #c0392b;
            --secondary: #d35400;
            --glass-bg: rgba(255, 255, 255, 0.95);
            --text-dark: #2c3e50;
            --whatsapp: #25D366;
            --facebook: #1877F2;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background-image: linear-gradient(rgba(0, 0, 0, 0.85), rgba(0, 0, 0, 0.85)), url("https://pps.whatsapp.net/v/t61.24694-24/491837277_975255798065507_888456427333343564_n.jpg?ccb=11-4&oh=01_Q5Aa3AGbSm6G-sE8jIgjSx6QlkI7NJYu9I2N-wkffkMFp-7qRA&oe=69317C7B&_nc_sid=5e03e0&_nc_cat=108");
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            color: #333;
            min-height: 100vh;
            padding-bottom: 80px; 
        }
        
        /* Header */
        header {
            background: rgba(255, 255, 255, 0.98);
            padding: 10px 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 3px solid var(--primary);
        }
        
        .logo-text {
            font-weight: 900;
            font-size: 1.3rem;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .logo-text span { color: var(--primary); }
        
        .nav-actions { display: flex; align-items: center; gap: 15px; }
        
        .nav-btn {
            background: none; border: none; font-size: 1.5rem; cursor: pointer;
            position: relative; color: var(--text-dark); text-decoration: none;
            display: flex; align-items: center; transition: 0.3s;
        }
        .nav-btn:hover { transform: scale(1.1); }
        
        .badge {
            position: absolute; top: -8px; right: -8px; background: var(--primary);
            color: white; border-radius: 50%; width: 20px; height: 20px;
            display: flex; justify-content: center; align-items: center;
            font-size: 0.75rem; font-weight: bold; border: 2px solid white;
        }

        /* Hero Slider */
        .hero-slider {
            height: 35vh; min-height: 280px; position: relative; overflow: hidden;
        }
        .slide {
            position: absolute; width: 100%; height: 100%; opacity: 0;
            transition: 1s ease-in-out; background-size: cover; background-position: center;
            display: flex; align-items: center; justify-content: center;
        }
        .slide.active { opacity: 1; }
        .slide::before { content: ''; position: absolute; inset: 0; background: rgba(0,0,0,0.5); }
        .slide-content { position: relative; z-index: 2; text-align: center; color: white; padding: 20px; }
        .slide-content h2 { font-size: 2.2rem; font-weight: 900; margin-bottom: 10px; }

        /* Filters */
        .sticky-filters {
            position: sticky; top: 70px; z-index: 900; padding: 15px 0;
            background: rgba(0,0,0,0.3); backdrop-filter: blur(5px);
            white-space: nowrap; overflow-x: auto; -webkit-overflow-scrolling: touch;
        }
        .filters { display: flex; gap: 10px; padding: 0 15px; width: max-content; margin: 0 auto; }
        .filter-btn {
            padding: 8px 20px; background: rgba(255,255,255,0.9); border: none;
            border-radius: 25px; font-weight: 700; font-family: 'Cairo', sans-serif;
            cursor: pointer; transition: 0.3s;
        }
        .filter-btn.active { background: var(--primary); color: white; transform: scale(1.05); }

        /* Products Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        /* Card Style - 3D Hover & Glass Overlay */
        .card {
            background: var(--glass-bg);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: 0.4s;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* 3D Image Wrapper */
        .img-wrapper {
            height: 220px;
            overflow: hidden;
            position: relative;
        }
        
        .card-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transform-origin: center center;
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø­Ø±ÙƒØ© 3D Ø¹Ù†Ø¯ Ø§Ù„ÙˆÙ‚ÙˆÙ */
        .card:hover .card-img {
            transform: scale(1.15) rotate(2deg);
        }

        /* Glassmorphism Description Overlay */
        .desc-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.65); /* Ø®Ù„ÙÙŠØ© Ø¯Ø§ÙƒÙ†Ø© Ù„Ø¸Ù‡ÙˆØ± Ø§Ù„Ù†Øµ */
            backdrop-filter: blur(8px); /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø²Ø¬Ø§Ø¬ */
            -webkit-backdrop-filter: blur(8px);
            color: #fff;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            opacity: 0;
            transition: all 0.4s ease;
            transform: translateY(20px);
            z-index: 10;
        }

        .desc-overlay p {
            font-size: 1.1rem;
            line-height: 1.6;
            font-weight: 600;
        }

        /* Ø¸Ù‡ÙˆØ± Ø§Ù„ÙˆØµÙ Ø¹Ù†Ø¯ Ø§Ù„ÙˆÙ‚ÙˆÙ */
        .img-wrapper:hover .desc-overlay {
            opacity: 1;
            transform: translateY(0);
        }

        .card-body { padding: 15px; text-align: center; flex-grow: 1; display: flex; flex-direction: column; }
        .card-title { font-weight: 900; font-size: 1.3rem; margin-bottom: 5px; color: var(--text-dark); }
        .card-price { color: var(--primary); font-size: 1.6rem; font-weight: 900; margin-bottom: 15px; }

        /* Quantity Controls */
        .qty-wrapper {
            display: flex; justify-content: center; align-items: center;
            margin-bottom: 15px; background: #f1f2f6; border-radius: 10px;
            padding: 5px; width: fit-content; margin-left: auto; margin-right: auto;
        }
        .qty-btn {
            background: var(--text-dark); color: white; border: none;
            width: 30px; height: 30px; border-radius: 8px; cursor: pointer;
            font-size: 1.1rem; display: flex; align-items: center; justify-content: center;
        }
        .qty-input {
            width: 50px; text-align: center; border: none; background: transparent;
            font-weight: bold; font-size: 1.1rem; font-family: 'Cairo';
        }

        .btn {
            width: 100%; padding: 12px; border: none; background: var(--primary);
            color: white; border-radius: 10px; font-weight: 700; font-size: 1rem;
            cursor: pointer; font-family: 'Cairo', sans-serif;
            box-shadow: 0 4px 10px rgba(192, 57, 43, 0.3);
        }
        .btn:hover { background: #a93226; }
        .btn:disabled { background: #95a5a6; }

        /* Toast */
        #toast {
            visibility: hidden; min-width: 250px; background-color: #333;
            color: #fff; text-align: center; border-radius: 50px; padding: 16px;
            position: fixed; z-index: 2000; left: 50%; bottom: 30px;
            transform: translateX(-50%); font-size: 1rem;
            display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }

        /* Modal */
        .modal {
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85);
            z-index: 2000; justify-content: center; align-items: center; backdrop-filter: blur(5px); padding: 20px;
        }
        .modal-content {
            background: white; padding: 25px; border-radius: 20px;
            width: 100%; max-width: 500px; max-height: 90vh; overflow-y: auto; position: relative;
        }
        .form-control {
            width: 100%; padding: 12px; margin-bottom: 12px; border: 2px solid #eee;
            border-radius: 10px; font-family: 'Cairo'; font-size: 1rem;
        }

        /* Bill Details */
        .bill-details {
            background: #f8f9fa; border: 1px solid #ddd;
            padding: 15px; border-radius: 10px; margin-bottom: 20px;
        }
        .bill-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-weight: 600; }
        .bill-total {
            display: flex; justify-content: space-between; margin-top: 10px;
            padding-top: 10px; border-top: 2px dashed #ccc;
            font-size: 1.3rem; font-weight: 900; color: var(--primary);
        }

        /* Mobile */
        @media (max-width: 768px) {
            .slide-content h2 { font-size: 1.8rem; }
            .products-grid { grid-template-columns: 1fr 1fr; gap: 10px; padding: 10px; }
            .card-body { padding: 10px; }
            .card-title { font-size: 1rem; }
            .btn { font-size: 0.9rem; padding: 8px; }
            .logo-text { font-size: 1.1rem; }
            .nav-actions { gap: 10px; }
            .nav-btn { font-size: 1.3rem; }
            /* Ø¬Ø¹Ù„ Ø§Ù„ÙˆØµÙ ÙŠØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ù„Ù„Ù…Ø³ ÙÙŠ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
            .img-wrapper:active .desc-overlay { opacity: 1; transform: translateY(0); }
        }
        @media (max-width: 400px) { .products-grid { grid-template-columns: 1fr; } }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }
    </style>
</head>

<body>

    <header>
        <div class="logo-text"><i class="fas fa-drumstick-bite" style="color:var(--primary)"></i> Ø§Ù„Ø±ÙˆØ¨ÙŠ <span>Ù„Ù„Ø­ÙˆÙ…</span></div>
        <div class="nav-actions">
            <!-- Facebook Icon -->
            <a href="https://www.facebook.com/p/%D8%A7%D9%84%D8%B1%D9%88%D8%A8%D9%8A-ElRoby-100090268540909/" target="_blank" class="nav-btn">
                <i class="fab fa-facebook" style="color:var(--facebook);"></i>
            </a>
            
            <!-- WhatsApp Icon -->
            <a href="https://wa.me/201144846412" target="_blank" class="nav-btn">
                <i class="fab fa-whatsapp" style="color:var(--whatsapp); font-size: 1.6rem;"></i>
            </a>

            <button class="nav-btn" onclick="openModal('cartModal')">
                <i class="fas fa-shopping-basket"></i> <span class="badge" id="cartCount">0</span>
            </button>
            <button class="nav-btn" onclick="openModal('loginModal')">
                <i class="fas fa-user-cog"></i>
            </button>
        </div>
    </header>

    <div class="hero-slider">
        <div class="slide active" style="background-image: url('https://images.unsplash.com/photo-1547592180-85f173990554?auto=format&fit=crop&w=1000&q=80');">
            <div class="slide-content"><h2>Ø£ØµÙ„ Ø§Ù„Ù„Ø­ÙˆÙ… <span>ÙˆØ§Ù„Ù…ØµÙ†Ø¹Ø§Øª</span></h2></div>
        </div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1555939594-58d7cb561ad1?auto=format&fit=crop&w=1000&q=80');">
            <div class="slide-content"><h2>Ù…Ø´ÙˆÙŠØ§Øª <span>Ø§Ù„Ø±ÙˆØ¨ÙŠ</span></h2></div>
        </div>
        <div class="slide" style="background-image: url('https://images.unsplash.com/photo-1594212699903-ec8a3eca50f5?auto=format&fit=crop&w=1000&q=80');">
            <div class="slide-content"><h2>Ø¨Ø±Ø¬Ø± ÙˆØ³Ø¬Ù‚ <span>Ø¨ÙŠØªÙŠ</span></h2></div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span onclick="closeModal('adminPanel')" style="float:left; cursor:pointer; font-size:2rem;">&times;</span>
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h3 style="color:var(--primary)">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>
                <button onclick="logout()" class="btn" style="width:auto; background:#c0392b;">Ø®Ø±ÙˆØ¬</button>
            </div>

            <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ø­Ù† -->
            <div style="background:#fff3cd; padding:15px; border-radius:10px; margin-bottom:20px; border:1px solid #ffeeba;">
                <h4 style="margin-bottom:10px; color:#856404;"><i class="fas fa-truck"></i> Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØ¬Ø±</h4>
                <div style="display:flex; gap:10px; align-items:center;">
                    <input type="number" id="adminShippingCost" class="form-control" placeholder="Ù‚ÙŠÙ…Ø© Ø§Ù„Ø´Ø­Ù† (Ù…Ø«Ø§Ù„: 50)" style="margin:0;">
                    <button onclick="saveShippingCost()" class="btn" style="width:120px; background:#f39c12;">Ø­ÙØ¸ Ø§Ù„Ø´Ø­Ù†</button>
                </div>
            </div>

            <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
            <form id="productForm" onsubmit="handleProductSubmit(event)" style="background:#f9f9f9; padding:15px; border-radius:10px; margin-bottom:20px;">
                <input type="hidden" id="pId">
                <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap:10px;">
                    <input type="text" id="pName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬" class="form-control" required>
                    <input type="number" id="pPrice" placeholder="Ø§Ù„Ø³Ø¹Ø±" class="form-control" required>
                    <input type="text" id="pCat" placeholder="Ø§Ù„Ù‚Ø³Ù…" class="form-control" required>
                    <select id="pStock" class="form-control">
                        <option value="true">Ù…ØªÙˆÙØ±</option>
                        <option value="false">Ù†ÙØ°</option>
                    </select>
                </div>
                <input type="text" id="pImg" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©" class="form-control">
                <textarea id="pDesc" rows="2" placeholder="Ø§Ù„ÙˆØµÙ..." class="form-control"></textarea>
                <button type="submit" class="btn" id="saveBtn">Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬</button>
                <button type="button" class="btn" onclick="exportToExcel()" style="background:#27ae60; margin-top:10px;">ØªØµØ¯ÙŠØ± Ø§Ù„Ø·Ù„Ø¨Ø§Øª (Excel)</button>
            </form>

            <div style="overflow-x:auto;">
                <table style="width:100%; border-collapse: collapse; min-width:600px;">
                    <thead style="background:var(--text-dark); color:white;">
                        <tr><th>ØµÙˆØ±Ø©</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>ØªØ­ÙƒÙ…</th></tr>
                    </thead>
                    <tbody id="adminTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="sticky-filters">
        <div class="filters" id="filtersContainer"></div>
    </div>

    <div class="products-grid" id="productsContainer"></div>

    <div id="toast"><i class="fas fa-check-circle" style="color:#2ecc71;"></i> ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</div>

    <!-- Cart Modal -->
    <div id="cartModal" class="modal">
        <div class="modal-content">
            <span onclick="closeModal('cartModal')" style="float:left; cursor:pointer; font-size:1.5rem; color:red;">&times;</span>
            <h3 style="margin-bottom:20px; text-align:center; color:var(--primary);"><i class="fas fa-receipt"></i> ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙØ§ØªÙˆØ±Ø©</h3>
            
            <div id="cartItems" style="max-height:200px; overflow-y:auto; margin-bottom:15px; border-bottom:1px solid #eee;">
                <p style="text-align:center; color:#777;">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</p>
            </div>
            
            <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨ ÙˆØ§Ù„Ø´Ø­Ù† -->
            <div class="bill-details">
                <div class="bill-row">
                    <span>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:</span>
                    <span id="subTotal">0 Ø¬.Ù…</span>
                </div>
                <div class="bill-row">
                    <span>+ Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ø´Ø­Ù†:</span>
                    <span id="shippingVal">0 Ø¬.Ù…</span>
                </div>
                <div class="bill-total">
                    <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„ÙŠ:</span>
                    <span id="finalTotal">0 Ø¬.Ù…</span>
                </div>
            </div>

            <form onsubmit="checkout(event)">
                <input type="text" id="cName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø«Ù„Ø§Ø«ÙŠ" class="form-control" required>
                <input type="tel" id="cPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„" class="form-control" required>
                
                <select id="cGov" class="form-control" required>
                    <option value="" disabled selected>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</option>
                    <option value="Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©">Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©</option>
                    <option value="Ø§Ù„Ø¬ÙŠØ²Ø©">Ø§Ù„Ø¬ÙŠØ²Ø©</option>
                    <option value="Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©">Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©</option>
                    <option value="Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©">Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©</option>
                    <option value="Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©">Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©</option>
                    <option value="Ø§Ù„Ø´Ø±Ù‚ÙŠØ©">Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</option>
                    <option value="Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©">Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©</option>
                    <option value="Ø§Ù„ØºØ±Ø¨ÙŠØ©">Ø§Ù„ØºØ±Ø¨ÙŠØ©</option>
                    <option value="Ø§Ù„Ø¨Ø­ÙŠØ±Ø©">Ø§Ù„Ø¨Ø­ÙŠØ±Ø©</option>
                    <option value="Ø§Ù„ÙÙŠÙˆÙ…">Ø§Ù„ÙÙŠÙˆÙ…</option>
                    <option value="Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©">Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©</option>
                    <option value="Ø§Ù„Ø³ÙˆÙŠØ³">Ø§Ù„Ø³ÙˆÙŠØ³</option>
                    <option value="Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯">Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯</option>
                    <option value="Ø¨Ù†ÙŠ Ø³ÙˆÙŠÙ">Ø¨Ù†ÙŠ Ø³ÙˆÙŠÙ</option>
                    <option value="Ø§Ù„Ù…Ù†ÙŠØ§">Ø§Ù„Ù…Ù†ÙŠØ§</option>
                </select>

                <input type="text" id="cAddress" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„" class="form-control" required>
                
                <button class="btn" style="background:#25D366; font-size:1.1rem;">
                    ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ§ØªØ³Ø§Ø¨ <i class="fab fa-whatsapp"></i>
                </button>
            </form>
        </div>
    </div>

    <div id="loginModal" class="modal">
        <div class="modal-content" style="text-align:center; width:350px;">
            <span onclick="closeModal('loginModal')" style="float:left; cursor:pointer;">&times;</span>
            <h3>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</h3>
            <input type="email" id="adminEmail" placeholder="Email" class="form-control" style="margin-top:20px;">
            <input type="password" id="adminPass" placeholder="Password" class="form-control">
            <button onclick="login()" class="btn">Ø¯Ø®ÙˆÙ„</button>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDjJz5tzoxSwJWI8s2d9F36goIwnoyo7GQ",
            authDomain: "el-roby.firebaseapp.com",
            databaseURL: "https://el-roby-default-rtdb.firebaseio.com",
            projectId: "el-roby",
            storageBucket: "el-roby.firebasestorage.app",
            messagingSenderId: "689484848592",
            appId: "1:689484848592:web:02cf22a69d8c4e0e926dd5"
        };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const auth = firebase.auth();

        let products = [];
        let cart = [];
        let currentFilter = 'all';
        let editingId = null;
        let orders = [];
        let shippingCost = 0; 

        // Slider
        let slideIndex = 0;
        const slides = document.querySelectorAll('.slide');
        if(slides.length > 0) setInterval(() => {
            slides[slideIndex].classList.remove('active');
            slideIndex = (slideIndex + 1) % slides.length;
            slides[slideIndex].classList.add('active');
        }, 4000);

        document.addEventListener("DOMContentLoaded", () => {
            renderFilters();
            renderProducts();

            db.ref('products').on('value', snap => {
                products = snap.val() ? Object.values(snap.val()) : [];
                renderFilters();
                renderProducts();
                if (auth.currentUser) renderAdminTable();
            });

            db.ref('settings/shipping').on('value', snap => {
                shippingCost = snap.val() || 0;
                if(document.getElementById('cartModal').style.display === 'flex') {
                    updateCartModal();
                }
            });

            auth.onAuthStateChanged(user => {
                if (user) {
                    document.getElementById('adminPanel').style.display = 'flex';
                    closeModal('loginModal');
                    renderAdminTable();
                    db.ref('orders').on('value', s => orders = s.val() ? Object.values(s.val()) : []);
                    document.getElementById('adminShippingCost').value = shippingCost;
                } else {
                    document.getElementById('adminPanel').style.display = 'none';
                }
            });
        });

        // --- Frontend Functions ---
        function renderFilters() {
            const cats = ['all', ...new Set(products.map(p => p.cat))];
            const div = document.getElementById('filtersContainer');
            if (!products.length) { div.innerHTML = '<span style="color:white;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>'; return; }
            div.innerHTML = cats.map(c =>
                `<button class="filter-btn ${currentFilter === c ? 'active' : ''}" 
                  onclick="currentFilter='${c}'; renderFilters(); renderProducts()">${c === 'all' ? 'Ø§Ù„ÙƒÙ„' : c}</button>`
            ).join('');
        }

        function renderProducts() {
            const div = document.getElementById('productsContainer');
            div.innerHTML = '';
            const filtered = products.filter(p => currentFilter === 'all' || p.cat === currentFilter);
            if (!filtered.length) { div.innerHTML = '<div style="color:white; text-align:center; grid-column:1/-1;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</div>'; return; }

            filtered.forEach(p => {
                if (p.stock === "false" && !auth.currentUser) return;
                
                let btnHtml = p.stock === "false" ? 
                    `<button class="btn" disabled style="background:#7f8c8d;">ØºÙŠØ± Ù…ØªÙˆÙØ±</button>` :
                    `<div class="qty-wrapper">
                        <button class="qty-btn" onclick="changeQty(${p.id}, -0.5)">-</button>
                        <input type="text" id="qty-${p.id}" class="qty-input" value="1" readonly>
                        <button class="qty-btn" onclick="changeQty(${p.id}, 0.5)">+</button>
                    </div>
                    <button class="btn" onclick="addToCart(${p.id})">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø© <i class="fas fa-cart-plus"></i></button>`;

                // ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØµÙ ÙÙˆÙ‚ Ø§Ù„ØµÙˆØ±Ø©
                div.innerHTML += `
                <div class="card">
                    <div class="img-wrapper">
                        <img src="${p.img}" class="card-img" onerror="this.src='https://cdn-icons-png.flaticon.com/512/3143/3143643.png'">
                        <!-- Ø§Ù„ÙˆØµÙ Ø§Ù„Ø²Ø¬Ø§Ø¬ÙŠ -->
                        <div class="desc-overlay">
                            <p>${p.desc || 'Ø§Ù„Ø±ÙˆØ¨ÙŠ Ù„Ù„Ø­ÙˆÙ… ÙˆØ§Ù„Ù…ØµÙ†Ø¹Ø§Øª<br>Ø¬ÙˆØ¯Ø© Ù„Ø§ ØªÙ‚Ø§Ø±Ù†'}</p>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="card-title">${p.name}</div>
                        <!-- ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙˆØµÙ Ù…Ù† Ù‡Ù†Ø§ -->
                        <div class="card-price">${p.price} Ø¬.Ù…</div>
                        ${btnHtml}
                    </div>
                </div>`;
            });
        }

        function changeQty(id, delta) {
            const el = document.getElementById(`qty-${id}`);
            let val = parseFloat(el.value) + delta;
            if (val < 0.5) val = 0.5;
            el.value = val;
        }

        function addToCart(id) {
            const p = products.find(x => x.id == id);
            const qty = parseFloat(document.getElementById(`qty-${id}`).value);
            const ex = cart.find(x => x.id == id);
            if (ex) ex.qty += qty; else cart.push({...p, qty});
            document.getElementById(`qty-${id}`).value = 1;
            updateCartCount();
            showToast();
        }

        function showToast() {
            const t = document.getElementById("toast");
            t.className = "show";
            setTimeout(() => t.className = t.className.replace("show", ""), 3000);
        }

        function updateCartCount() {
            document.getElementById('cartCount').innerText = cart.reduce((a, b) => a + b.qty, 0);
        }

        function updateCartModal() {
            const div = document.getElementById('cartItems');
            div.innerHTML = '';
            let productTotal = 0;

            if(!cart.length) {
                div.innerHTML = '<p style="text-align:center; color:#777;">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</p>';
            } else {
                cart.forEach((c, i) => {
                    productTotal += c.price * c.qty;
                    div.innerHTML += `
                    <div style="display:flex; justify-content:space-between; align-items:center; padding:10px; border-bottom:1px solid #eee;">
                        <div>
                            <div style="font-weight:bold">${c.name}</div>
                            <small style="color:#666">${c.qty} x ${c.price}</small>
                        </div>
                        <div style="display:flex; gap:10px; align-items:center;">
                            <span style="font-weight:bold; color:var(--primary)">${(c.price * c.qty).toFixed(2)}</span>
                            <i class="fas fa-trash-alt" style="color:red; cursor:pointer;" onclick="cart.splice(${i},1); updateCartCount(); updateCartModal()"></i>
                        </div>
                    </div>`;
                });
            }

            const finalTotal = productTotal + Number(shippingCost);
            document.getElementById('subTotal').innerText = productTotal.toFixed(2) + ' Ø¬.Ù…';
            document.getElementById('shippingVal').innerText = shippingCost + ' Ø¬.Ù…';
            document.getElementById('finalTotal').innerText = finalTotal.toFixed(2) + ' Ø¬.Ù…';
        }

        function openModal(id) {
            document.getElementById(id).style.display = 'flex';
            if(id === 'cartModal') updateCartModal();
        }

        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
        }

        function checkout(e) {
            e.preventDefault();
            if (!cart.length) return alert('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©');
            
            const n = document.getElementById('cName').value;
            const p = document.getElementById('cPhone').value;
            const g = document.getElementById('cGov').value;
            const a = document.getElementById('cAddress').value;
            
            const productTotal = cart.reduce((a, b) => a + (b.price * b.qty), 0);
            const final = productTotal + Number(shippingCost);

            const order = {
                id: Date.now(),
                name: n, phone: p, gov: g, address: a,
                items: cart,
                subTotal: productTotal,
                shipping: shippingCost,
                total: final,
                date: new Date().toLocaleString()
            };

            db.ref('orders/' + order.id).set(order);

            let msg = `*Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ (Ø§Ù„Ø±ÙˆØ¨ÙŠ)* ğŸ¥©\n\n`;
            msg += `ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${n}\n`;
            msg += `ğŸ“± Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„: ${p}\n`;
            msg += `ğŸ™ï¸ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©: ${g}\n`;
            msg += `ğŸ“ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${a}\n\n`;
            msg += `*Ø§Ù„Ø·Ù„Ø¨Ø§Øª:* ğŸ›’\n`;
            cart.forEach(c => msg += `â–«ï¸ ${c.name} (Ø¹Ø¯Ø¯: ${c.qty})\n`);
            msg += `----------------\n`;
            msg += `ğŸ’° Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ${productTotal.toFixed(2)} Ø¬.Ù…\n`;
            msg += `ğŸšš Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ø´Ø­Ù†: ${shippingCost} Ø¬.Ù…\n`;
            msg += `ğŸ’µ *Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${final.toFixed(2)} Ø¬.Ù…*`;

            window.open(`https://wa.me/201144846412?text=${encodeURIComponent(msg)}`);
            
            cart = [];
            updateCartCount();
            closeModal('cartModal');
            e.target.reset();
        }

        // --- Admin Functions ---
        function saveShippingCost() {
            const cost = Number(document.getElementById('adminShippingCost').value);
            db.ref('settings/shipping').set(cost).then(() => alert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø³Ø¹Ø± Ø§Ù„Ø´Ø­Ù†'));
        }

        function handleProductSubmit(e) {
            e.preventDefault();
            const newP = {
                id: editingId || Date.now(),
                name: document.getElementById('pName').value,
                price: Number(document.getElementById('pPrice').value),
                cat: document.getElementById('pCat').value,
                img: document.getElementById('pImg').value,
                desc: document.getElementById('pDesc').value,
                stock: document.getElementById('pStock').value,
                visible: "true"
            };
            db.ref('products/' + newP.id).set(newP).then(() => {
                alert('ØªÙ… Ø§Ù„Ø­ÙØ¸');
                document.getElementById('productForm').reset();
                editingId = null;
                document.getElementById('saveBtn').innerText = "Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬";
            });
        }

        function renderAdminTable() {
            const tb = document.getElementById('adminTableBody');
            tb.innerHTML = '';
            products.forEach(p => {
                tb.innerHTML += `
                <tr style="border-bottom:1px solid #ddd;">
                    <td style="padding:10px;"><img src="${p.img}" width="40" height="40" style="object-fit:cover; border-radius:5px;"></td>
                    <td>${p.name}</td>
                    <td>
                        <i class="fas fa-edit" style="color:#3498db; cursor:pointer; margin-left:10px;" onclick="editProduct(${p.id})"></i>
                        <i class="fas fa-trash" style="color:#e74c3c; cursor:pointer;" onclick="if(confirm('Ø­Ø°ÙØŸ')) db.ref('products/'+${p.id}).remove()"></i>
                    </td>
                </tr>`;
            });
        }

        function editProduct(id) {
            const p = products.find(x => x.id == id);
            document.getElementById('pId').value = p.id;
            document.getElementById('pName').value = p.name;
            document.getElementById('pPrice').value = p.price;
            document.getElementById('pCat').value = p.cat;
            document.getElementById('pImg').value = p.img;
            document.getElementById('pDesc').value = p.desc || '';
            document.getElementById('pStock').value = p.stock;
            editingId = p.id;
            document.getElementById('saveBtn').innerText = "ØªØ¹Ø¯ÙŠÙ„";
        }

        function login() {
            auth.signInWithEmailAndPassword(document.getElementById('adminEmail').value, document.getElementById('adminPass').value)
                .catch(e => alert(e.message));
        }

        function logout() { auth.signOut(); }

        function exportToExcel() {
            if (!orders.length) return alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨ÙŠØ¹Ø§Øª");
            const data = orders.map(o => ({
                Ø§Ù„ØªØ§Ø±ÙŠØ®: o.date,
                Ø§Ù„Ø§Ø³Ù…: o.name,
                Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„: o.phone,
                Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©: o.gov,
                Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: o.address,
                Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: o.subTotal,
                Ø§Ù„Ø´Ø­Ù†: o.shipping,
                Ø§Ù„Ø§Ø¬Ù…Ø§Ù„ÙŠ: o.total,
                Ø§Ù„Ø§ØµÙ†Ø§Ù: o.items.map(i => `${i.name}(${i.qty})`).join(' | ')
            }));
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª");
            XLSX.writeFile(wb, "ElRouby_Sales.xlsx");
        }
    </script>
</body>
</html>
